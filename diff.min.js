function SimpleDiff(c,f,d){this.index={};this.min_match=d||2;for(c=0;c<f.length;c++){f[c]in this.index||(this.index[f[c]]=[]);this.index[f[c]].push(c)}};SimpleDiff.prototype={longest_common_substring:function(c,f,d,e){var g={},h=0,i=0,j=0,k={};for(c=c;c<f;c++){var l=this.index[a[c]],o;for(o in this.index[a[c]]){var m=l[o];if(d<=m&&m<e){var n=k[m]=(g[m-1]||0)+1;if(n>=this.min_match&&n>j){h=c;i=m;j=n}}}g=k;k={}}return[h-j+1,i-j+1,j]},find_matches:function(){for(var c=[[0,0,0],[a.length,b.length,0]],f=[[0,a.length,0,b.length]];f.length>0;){var d=f.pop(),e=this.longest_common_substring.apply(this,d),g=e[0],h=e[1],i=e[2];if(i>=this.min_match){c.push(e); f.push([d[0],g,d[2],h]);f.push([g+i,d[1],h+i,d[3]])}}c.sort(function(j,k){for(var l in[0,1,2]){if(j[l]<k[l])return-1;if(j[l]>k[l])return 1}return 0});return c},compare:function(){for(var c=[],f=this.find_matches(),d=0;d<f.length-1;d++){var e=f[d],g=f[d+1],h=g[0]-e[0]-e[2],i=g[1]-e[1]-e[2];e[0]+e[2]>0&&c.push([" ",a.substring(e[0],e[0]+e[2])]);h>0&&c.push(["-",a.substring(e[0]+e[2],g[0])]);i>0&&c.push(["+",b.substring(e[1]+e[2],g[1])])}return c},ndiff:function(){var c=[],f=this.compare(),d;for(d in f){var e=f[d][0],g=f[d][1],h;for(h in g)c.push(e+" "+h)}return c},toString:function(){var c=this.compare(),f=[],d;for(d in c)f.push("['"+c[d][0]+"', '"+c[d][1]+"']");return"["+f.join(", ")+"]"}};function html_diff(c,f){var d=(new SimpleDiff(c,f)).compare(),e="",g;for(g in d)if(d[g][0]==" ")e+=d[g][1];else if(d[g][0]=="-")e+="<del>"+d[g][1]+"</del>";else if(d[g][0]=="+")e+="<ins>"+d[g][1]+"</ins>";return e};
